<div class="bg-white-shadow rounded-3 mt-4 p-4">
    <div>
        <h3 class="fw-bold">Resumen del pedido</h3>
    </div>

    <div class="mt-4 d-flex flex-column gap-2">
        <div class="d-flex justify-content-between">
            <p class="m-0 p-0 text-light">Subtotal ({{ cartService.countItems() }} artículos)</p>
            <p class="m-0 p-0 fw-bold">{{ cartService.subtotal().toFixed(2) }} €</p>
        </div>
        <div class="d-flex justify-content-between">
            <p class="m-0 p-0 text-light">Envío estimado</p>
            <p class="m-0 p-0 fw-bold">{{ cartService.delivery().toFixed(2) }} €</p>
        </div>
        <div class="d-flex justify-content-between">
            <p class="m-0 p-0 text-light">IVA (4%)</p>
            <p class="m-0 p-0 fw-bold">{{ cartService.iva().toFixed(2) }} €</p>
        </div>

        @if (cartService.cupon()) {
            <div class="d-flex justify-content-between text-success">
                <p class="m-0 p-0">Descuento ({{cartService.cupon().code}} - {{cartService.cupon().discount}}%)</p>
                <p class="m-0 p-0 fw-bold">{{cartService.discount().toFixed(2)}}€</p>
            </div>

            <div class="d-flex justify-content-end">
                <button class="btn btn_delete text-danger p-0 m-0 border-0" (click)="deleteCupon()">
                    Eliminar cupon
                    <i class="fa-solid fa-delete-left"></i>
                </button>
            </div>
        }
    </div>

    @if (!cartService.cupon()) {
        <form class="inp-search d-flex justify-content-between p-2 mt-4" [formGroup]="formCupon">
            <input type="text" class="w-75" placeholder="Código de promoción"
                   formControlName="code"
            >
            <button class="btn btn-primary w-25" [disabled]="formCupon.invalid" (click)="validateCupon()">Aplicar
            </button>
        </form>
    }

    <div class="d-flex justify-content-between mt-4 align-items-center">
        <p class="m-0 p-0 fw-semibold">Total</p>
        <p class="m-0 p-0 fw-bold fs-4">{{ cartService.total().toFixed(2) }} €</p>
    </div>

    <button class="btn btn-primary w-100 mt-4 fw-bold py-2"
            [disabled]="cartService.countItems()<=0 || formPayment()?.invalid"
            (click)="verify()"
    >
        {{ nameButton() }}
        <i class="fa-solid fa-arrow-right ps-3"></i>
    </button>

    <div class="mt-5 d-flex flex-column gap-2">
        <div class="d-flex gap-2 align-items-center justify-content-center">
            <i class="fa-solid fa-shield-halved text-success"></i>
            <span class="text-light fw-semibold">Pago seguro</span>
        </div>

        <div class="d-flex gap-3 text-light fs-4 justify-content-center">
            <i class="fa-brands fa-cc-visa"></i>
            <i class="fa-brands fa-cc-mastercard"></i>
            <i class="fa-brands fa-cc-stripe"></i>
            <i class="fa-brands fa-cc-paypal"></i>
        </div>
    </div>

</div>